<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Header Test | Experience Ecuador</title>

  <!-- Favicons (root) -->
  <link rel="icon" href="/favicon.ico">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand-blue:#034EA2;
      --nav-text:#0f2f62;
      --bg: #f6f8fb;
      --card:#ffffff;
      --border: rgba(0,0,0,.08);
      --shadow: 0 18px 55px rgba(3,78,162,.12);
      --radius: 18px;
    }

    /* Page styling */
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      background:var(--bg);
      color:#1F1F1F;
    }
    main{
      max-width:1100px;
      margin:0 auto;
      padding:40px 18px 120px;
    }
    .card{
      background:var(--card);
      border-radius:22px;
      border:1px solid rgba(0,0,0,.06);
      box-shadow:var(--shadow);
      padding:22px;
    }
    h1{
      margin:0 0 10px;
      font-family:Montserrat,Inter,sans-serif;
      font-weight:800;
      letter-spacing:-0.03em;
      color:var(--brand-blue);
      font-size:clamp(28px,4vw,48px);
    }
    p{ margin:0; line-height:1.7; color:#1f2b3f; }

    /* =========================
       HEADER (DESKTOP + MOBILE)
       ========================= */
    .topbar, .topbar *{ box-sizing:border-box; }
    .topbar a, .topbar button{ font:inherit; color:inherit; }
    .topbar a{ text-decoration:none; }
    .topbar a:hover{ text-decoration:none; }

    .topbar{
      position:sticky;
      top:0;
      z-index:1000;
      backdrop-filter:saturate(160%) blur(10px);
      background:rgba(255,255,255,.78);
      border-bottom:1px solid rgba(0,0,0,.06);
    }

    .topbar-inner{
      max-width:1100px;
      margin:0 auto;
      padding:14px 18px;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
    }

    .brand{
      display:flex;
      align-items:center;
      gap:10px;
      white-space:nowrap;
      line-height:1;
      font-family:Montserrat,Inter,sans-serif;
      font-weight:800;
      letter-spacing:-0.02em;
      color:var(--brand-blue);
      font-size:18px;
    }
    .brand img{ width:28px; height:28px; object-fit:contain; }

    /* Desktop nav */
    .nav-desktop{
      display:flex;
      align-items:center;
      gap:18px;
      font-weight:700;
      font-size:14px;
      color:var(--nav-text);
      white-space:nowrap;
    }
    .nav-desktop a,
    .nav-desktop button{
      background:transparent;
      border:0;
      padding:8px 10px;
      border-radius:10px;
      cursor:pointer;
      line-height:1;
    }
    .nav-desktop a:hover,
    .nav-desktop button:hover{ background:rgba(3,78,162,.08); }

    /* Desktop dropdowns (simple) */
    .dd{ position:relative; }
    .dd-menu{
      position:absolute;
      top:42px;
      right:0;
      min-width:220px;
      background:#fff;
      border:1px solid rgba(0,0,0,0.08);
      border-radius:14px;
      box-shadow:0 18px 55px rgba(3,78,162,0.16);
      padding:8px;
      display:none;
      z-index:1200;
    }
    .dd-menu a{
      display:block;
      padding:10px 10px;
      border-radius:10px;
      font-weight:700;
      color:var(--nav-text);
    }
    .dd-menu a:hover{ background:rgba(3,78,162,.08); }
    .dd.open .dd-menu{ display:block; }

    .caret{
      width:10px;height:10px;display:inline-block;
      border-right:2px solid currentColor;
      border-bottom:2px solid currentColor;
      transform:rotate(45deg);
      margin-left:6px;
      margin-top:-2px;
      opacity:.7;
    }

    /* Mobile controls */
    .nav-toggle{
      display:none;
      align-items:center;
      justify-content:center;
      width:44px;
      height:44px;
      border-radius:14px;
      border:1px solid rgba(0,0,0,.10);
      background:rgba(255,255,255,.9);
      cursor:pointer;
    }
    .burger{
      width:18px;
      height:12px;
      position:relative;
      display:block;
    }
    .burger span{
      position:absolute;
      left:0;
      right:0;
      height:2px;
      background:var(--nav-text);
      border-radius:2px;
    }
    .burger span:nth-child(1){ top:0; }
    .burger span:nth-child(2){ top:5px; }
    .burger span:nth-child(3){ top:10px; }

    /* Mobile overlay */
    .mobile-overlay{
      position:fixed;
      inset:0;
      background:rgba(15, 47, 98, .18);
      opacity:0;
      pointer-events:none;
      transition:opacity .18s ease;
      z-index:1500;
    }
    .mobile-overlay.open{
      opacity:1;
      pointer-events:auto;
    }

    .mobile-drawer{
      position:fixed;
      top:0;
      right:0;
      height:100vh;
      width:min(92vw, 420px);
      background:#fff;
      border-left:1px solid rgba(0,0,0,.08);
      box-shadow: -24px 0 70px rgba(3,78,162,.18);
      transform:translateX(105%);
      transition:transform .22s ease;
      z-index:1600;
      display:flex;
      flex-direction:column;
    }
    .mobile-drawer.open{ transform:translateX(0); }

    .mobile-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      padding:14px 14px;
      border-bottom:1px solid rgba(0,0,0,.06);
    }
    .mobile-title{
      font-weight:800;
      color:var(--nav-text);
      font-family:Montserrat,Inter,sans-serif;
      letter-spacing:-0.01em;
      font-size:16px;
    }
    .mobile-close{
      width:44px;height:44px;
      border-radius:14px;
      border:1px solid rgba(0,0,0,.10);
      background:rgba(255,255,255,.9);
      cursor:pointer;
      position:relative;
    }
    .mobile-close:before,
    .mobile-close:after{
      content:"";
      position:absolute;
      left:50%; top:50%;
      width:18px; height:2px;
      background:var(--nav-text);
      border-radius:2px;
      transform-origin:center;
    }
    .mobile-close:before{ transform:translate(-50%,-50%) rotate(45deg); }
    .mobile-close:after{ transform:translate(-50%,-50%) rotate(-45deg); }

    .mobile-body{
      padding:14px;
      overflow:auto;
      -webkit-overflow-scrolling:touch;
    }

    .m-list{
      list-style:none;
      padding:0;
      margin:0;
      display:flex;
      flex-direction:column;
      gap:10px;
    }
    .m-item, .m-link, .m-btn{
      display:flex;
      align-items:center;
      justify-content:space-between;
      width:100%;
      padding:14px 14px;
      border-radius:16px;
      border:1px solid rgba(0,0,0,.08);
      background:#fff;
      font-weight:800;
      color:var(--nav-text);
      font-size:18px;
      line-height:1;
      cursor:pointer;
      text-decoration:none;
    }
    .m-btn .chev{
      width:10px;height:10px;
      border-right:2px solid currentColor;
      border-bottom:2px solid currentColor;
      transform:rotate(-45deg);
      opacity:.65;
      margin-left:10px;
    }
    .m-back{
      display:flex;
      align-items:center;
      gap:10px;
      width:100%;
      padding:12px 14px;
      border-radius:16px;
      border:1px solid rgba(0,0,0,.08);
      background:#fff;
      font-weight:800;
      color:var(--nav-text);
      cursor:pointer;
      margin-bottom:12px;
    }
    .m-back .arrow{
      width:10px;height:10px;
      border-left:2px solid currentColor;
      border-bottom:2px solid currentColor;
      transform:rotate(45deg);
      opacity:.65;
    }

    .submenu{ display:none; }
    .submenu.active{ display:block; }
    .mainmenu.active{ display:block; }
    .mainmenu{ display:none; }

    /* Desktop vs mobile break */
    @media (max-width: 720px){
      .topbar-inner{
        max-width:100%;
        margin:0;
        padding-left:calc(env(safe-area-inset-left) + 14px);
        padding-right:calc(env(safe-area-inset-right) + 14px);
      }
      .nav-desktop{ display:none; }
      .nav-toggle{ display:flex; }
    }
  </style>
</head>

<body>

  <!-- HEADER -->
  <header class="topbar">
    <div class="topbar-inner">
      <a class="brand" href="/">
        <img src="/assets/icons/EE-Logo-Assets-Pin-3.png" alt="Experience Ecuador pin">
        <span>Experience Ecuador</span>
      </a>

      <!-- Desktop nav -->
      <nav class="nav-desktop" aria-label="Primary navigation">
        <a href="/">Home</a>
        <a href="/about/">About</a>
        <a href="/mission/">Mission</a>

        <div class="dd" data-dd>
          <button class="dd-btn" type="button" aria-haspopup="true" aria-expanded="false">
            Regions <span class="caret" aria-hidden="true"></span>
          </button>
          <div class="dd-menu" role="menu" aria-label="Regions submenu">
            <a href="/regions/" role="menuitem">All Regions</a>
            <a href="/regions/galapagos/" role="menuitem">Galapagos</a>
            <a href="/regions/coast/" role="menuitem">Coast</a>
            <a href="/regions/andes/" role="menuitem">Andes</a>
            <a href="/regions/amazon/" role="menuitem">Amazon</a>
          </div>
        </div>

        <div class="dd" data-dd>
          <button class="dd-btn" type="button" aria-haspopup="true" aria-expanded="false">
            Experiences <span class="caret" aria-hidden="true"></span>
          </button>
          <div class="dd-menu" role="menu" aria-label="Experiences submenu">
            <a href="/experiences/" role="menuitem">All Experiences</a>
            <a href="/experiences/adventure/" role="menuitem">Adventure</a>
            <a href="/experiences/nature/" role="menuitem">Nature</a>
            <a href="/experiences/wildlife-birding/" role="menuitem">Wildlife &amp; Birding</a>
            <a href="/experiences/relaxation/" role="menuitem">Relaxation</a>
            <a href="/experiences/culinary/" role="menuitem">Culinary</a>
            <a href="/experiences/culture/" role="menuitem">Culture</a>
          </div>
        </div>

        <a href="/trip-builder/">Trip Builder</a>
        <a href="/contact/">Contact</a>
      </nav>

      <!-- Mobile hamburger -->
      <button class="nav-toggle" type="button" aria-label="Open menu" aria-expanded="false">
        <span class="burger" aria-hidden="true">
          <span></span><span></span><span></span>
        </span>
      </button>
    </div>
  </header>

  <!-- MOBILE OVERLAY + DRAWER -->
  <div class="mobile-overlay" data-overlay></div>

  <aside class="mobile-drawer" role="dialog" aria-modal="true" aria-label="Mobile menu" hidden>
    <div class="mobile-head">
      <div class="mobile-title">Menu</div>
      <button class="mobile-close" type="button" aria-label="Close menu"></button>
    </div>

    <div class="mobile-body">
      <!-- MAIN MENU -->
      <div class="mainmenu active" data-panel="main">
        <ul class="m-list">
          <li><a class="m-link" href="/">Home</a></li>
          <li><a class="m-link" href="/about/">About</a></li>
          <li><a class="m-link" href="/mission/">Mission</a></li>
          <li>
            <button class="m-btn" type="button" data-go="regions">
              Regions <span class="chev" aria-hidden="true"></span>
            </button>
          </li>
          <li>
            <button class="m-btn" type="button" data-go="experiences">
              Experiences <span class="chev" aria-hidden="true"></span>
            </button>
          </li>
          <li><a class="m-link" href="/trip-builder/">Trip Builder</a></li>
          <li><a class="m-link" href="/contact/">Contact</a></li>
        </ul>
      </div>

      <!-- REGIONS SUBMENU -->
      <div class="submenu" data-panel="regions">
        <button class="m-back" type="button" data-back>
          <span class="arrow" aria-hidden="true"></span> Back
        </button>
        <ul class="m-list">
          <li><a class="m-link" href="/regions/">All Regions</a></li>
          <li><a class="m-link" href="/regions/galapagos/">Galapagos</a></li>
          <li><a class="m-link" href="/regions/coast/">Coast</a></li>
          <li><a class="m-link" href="/regions/andes/">Andes</a></li>
          <li><a class="m-link" href="/regions/amazon/">Amazon</a></li>
        </ul>
      </div>

      <!-- EXPERIENCES SUBMENU -->
      <div class="submenu" data-panel="experiences">
        <button class="m-back" type="button" data-back>
          <span class="arrow" aria-hidden="true"></span> Back
        </button>
        <ul class="m-list">
          <li><a class="m-link" href="/experiences/">All Experiences</a></li>
          <li><a class="m-link" href="/experiences/adventure/">Adventure</a></li>
          <li><a class="m-link" href="/experiences/nature/">Nature</a></li>
          <li><a class="m-link" href="/experiences/wildlife-birding/">Wildlife &amp; Birding</a></li>
          <li><a class="m-link" href="/experiences/relaxation/">Relaxation</a></li>
          <li><a class="m-link" href="/experiences/culinary/">Culinary</a></li>
          <li><a class="m-link" href="/experiences/culture/">Culture</a></li>
        </ul>
      </div>
    </div>
  </aside>

  <main>
    <div class="card">
      <h1>Header Test Page</h1>
      <p>Use this page to test desktop spacing and the mobile hamburger menu.</p>
    </div>
  </main>

  <script>
    (function(){
      const toggle = document.querySelector('.nav-toggle');
      const overlay = document.querySelector('[data-overlay]');
      const drawer = document.querySelector('.mobile-drawer');
      const closeBtn = document.querySelector('.mobile-close');

      const panels = Array.from(document.querySelectorAll('[data-panel]'));
      const showPanel = (name) => {
        panels.forEach(p => p.classList.remove('active'));
        const el = document.querySelector('[data-panel="' + name + '"]');
        if(el) el.classList.add('active');
      };

      const openMenu = () => {
        if(!drawer) return;
        drawer.hidden = false;
        requestAnimationFrame(() => {
          overlay.classList.add('open');
          drawer.classList.add('open');
          toggle.setAttribute('aria-expanded','true');
          showPanel('main');
        });
        document.documentElement.style.overflow = 'hidden';
      };

      const closeMenu = () => {
        overlay.classList.remove('open');
        drawer.classList.remove('open');
        toggle.setAttribute('aria-expanded','false');
        document.documentElement.style.overflow = '';
        setTimeout(() => { drawer.hidden = true; }, 220);
      };

      // Toggle
      toggle && toggle.addEventListener('click', () => {
        const isOpen = toggle.getAttribute('aria-expanded') === 'true';
        if(isOpen) closeMenu();
        else openMenu();
      });

      // Close controls
      overlay && overlay.addEventListener('click', closeMenu);
      closeBtn && closeBtn.addEventListener('click', closeMenu);

      // Submenu navigation
      document.addEventListener('click', (e) => {
        const go = e.target.closest('[data-go]');
        if(go){
          const name = go.getAttribute('data-go');
          showPanel(name);
        }
        const back = e.target.closest('[data-back]');
        if(back){
          showPanel('main');
        }
      });

      // Desktop dropdowns
      const dds = Array.from(document.querySelectorAll('.dd[data-dd]'));
      const closeDD = () => {
        dds.forEach(dd => {
          dd.classList.remove('open');
          const btn = dd.querySelector('.dd-btn');
          btn && btn.setAttribute('aria-expanded','false');
        });
      };

      dds.forEach(dd => {
        const btn = dd.querySelector('.dd-btn');
        if(!btn) return;
        btn.addEventListener('click', (e) => {
          e.preventDefault();
          const isOpen = dd.classList.contains('open');
          closeDD();
          if(!isOpen){
            dd.classList.add('open');
            btn.setAttribute('aria-expanded','true');
          }
        });
      });

      document.addEventListener('click', (e) => {
        if(!e.target.closest('.dd[data-dd]')) closeDD();
      });

      document.addEventListener('keydown', (e) => {
        if(e.key === 'Escape'){
          closeDD();
          closeMenu();
        }
      });

      // Close mobile menu only when switching to desktop
      const mq = window.matchMedia('(min-width: 721px)');
      const onChange = (ev) => { if(ev.matches) closeMenu(); };
      if(mq.addEventListener) mq.addEventListener('change', onChange);
      else mq.addListener(onChange);
    })();
  </script>
</body>
</html>
