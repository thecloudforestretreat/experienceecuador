<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <!-- SEO & Metadata -->
  <title>Amazon (Oriente) | Experience Ecuador</title>
  <meta name="description" content="Plan Ecuador’s Amazon (Oriente) with this region hub. Choose gateways, lodges, and reserves, then build a 2 to 8 day rainforest itinerary around guided wildlife experiences." />
  <link rel="canonical" href="https://experienceecuador.com/regions/amazon/" />

  <link rel="alternate" hreflang="en" href="https://experienceecuador.com/regions/amazon/" />
  <link rel="alternate" hreflang="es" href="https://experienceecuador.com/es/regiones/amazonas/" />
  <link rel="alternate" hreflang="x-default" href="https://experienceecuador.com/regions/amazon/" />

  <!-- Open Graph -->
  <meta property="og:type" content="website" />
  <meta property="og:site_name" content="Experience Ecuador" />
  <meta property="og:title" content="Amazon (Oriente) | Experience Ecuador" />
  <meta property="og:description" content="Plan Ecuador’s Amazon (Oriente) with this region hub. Choose gateways, lodges, and reserves, then build a 2 to 8 day rainforest itinerary around guided wildlife experiences." />
  <meta property="og:url" content="https://experienceecuador.com/regions/amazon/" />
  <meta property="og:image" content="https://experienceecuador.com/assets/images/EE-OG-Image-1.jpg" />
  <meta property="og:image:secure_url" content="https://experienceecuador.com/assets/images/EE-OG-Image-1.jpg" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta property="og:image:alt" content="Experience Ecuador travel guide" />

  <!-- Twitter -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Amazon (Oriente) | Experience Ecuador" />
  <meta name="twitter:description" content="Plan Ecuador’s Amazon (Oriente) with this region hub. Choose gateways, lodges, and reserves, then build a 2 to 8 day rainforest itinerary around guided wildlife experiences." />
  <meta name="twitter:image" content="https://experienceecuador.com/assets/images/EE-OG-Image-1.jpg" />

  <!-- Favicons (root paths) -->
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/apple-touch-icon.png">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#034EA2">

  <!-- Global header/footer CSS (required) -->
  <link rel="stylesheet" href="/assets/css/header.css">
  <link rel="stylesheet" href="/assets/css/footer.css">

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

  <style>
    :root{
      --brand-blue:#034EA2;
      --cloud-white:#F5F7FA;
      --charcoal:#1F1F1F;
      --slate:#6E7B8B;
      --light-gray:#E3E5E8;
    }

    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;
      color:var(--charcoal);
      background:#f6f8fb;
    }

    a{text-decoration:none;color:inherit}
    img{max-width:100%;display:block}
    img{ user-select:none; -webkit-user-drag:none; }

    /* ===== HERO ===== */
    .hero{
      position:relative;
      width:100%;
      min-height:64vh;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      background:url("/assets/images/EE-Region-Amazon-hero-01.jpg") center / cover no-repeat;
      color:#fff;
    }

    .hero::before{
      content:"";
      position:absolute;
      inset:0;
      background:linear-gradient(
        to bottom,
        rgba(0,0,0,0.14),
        rgba(0,0,0,0.72)
      );
    }

    .hero-inner{
      position:relative;
      z-index:2;
      width:100%;
      max-width:1100px;
      padding:54px 18px 34px;
      text-align:left;
    }

    .kicker{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(3,78,162,0.38);
      border:1px solid rgba(255,255,255,0.22);
      font-weight:700;
      letter-spacing:0.02em;
      font-size:12.5px;
      margin-bottom:14px;
      backdrop-filter:blur(10px);
    }

    .hero h1{
      margin:0 0 10px;
      font-family:Montserrat,Inter,sans-serif;
      font-weight:800;
      letter-spacing:-0.03em;
      font-size:clamp(40px,5.4vw,72px);
      line-height:1.03;
    }

    .hero p{
      margin:0;
      max-width:70ch;
      font-size:clamp(15px,2vw,18px);
      line-height:1.65;
      color:rgba(255,255,255,0.92);
    }

    /* ===== PAGE WRAP ===== */
    .wrap{
      max-width:1100px;
      margin:0 auto;
      padding:36px 18px 0;
    }

    /* ===== SECTION / CARDS ===== */
    .section{ margin-bottom:26px; }

    .section h2{
      margin:0 0 10px;
      font-family:Montserrat,Inter,sans-serif;
      font-weight:800;
      letter-spacing:-0.02em;
      font-size:24px;
      color:var(--brand-blue);
    }

    .section p{
      margin:0;
      color:#2a2f36;
      font-size:15.8px;
      line-height:1.75;
      max-width:82ch;
    }

    .grid{
      display:grid;
      grid-template-columns:1.15fr 0.85fr;
      gap:22px;
      align-items:start;
      margin-top:18px;
    }

    .grid.center-stack{ align-items:center; }

    .stack-right{
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    .card{
      background:#fff;
      border-radius:22px;
      border:1px solid rgba(0,0,0,0.06);
      box-shadow:0 18px 55px rgba(3,78,162,0.12);
      padding:22px;
    }

    .card h3{
      margin:0 0 10px;
      font-family:Montserrat,Inter,sans-serif;
      font-weight:800;
      letter-spacing:-0.02em;
      font-size:18px;
      color:#0f2f62;
    }

    .card ul{
      margin:0;
      padding-left:18px;
      color:#24324a;
      line-height:1.75;
      font-size:14.8px;
    }

    .mini{
      background:linear-gradient(180deg, rgba(3,78,162,0.06), rgba(3,78,162,0.02));
      border:1px solid rgba(3,78,162,0.12);
      border-radius:20px;
      padding:20px;
    }

    .pill-row{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top:14px;
    }

    .tag{
      display:inline-flex;
      padding:8px 12px;
      border-radius:999px;
      background:rgba(3,78,162,0.08);
      border:1px solid rgba(3,78,162,0.12);
      color:#0f2f62;
      font-weight:700;
      font-size:13px;
    }

    /* ===== PLACES GRID (IMAGE HEADER TILES) ===== */
    .places-grid{
      display:grid;
      grid-template-columns:repeat(2, 1fr);
      gap:12px;
      margin-top:10px;
    }

    .place-tile{
      display:block;
      padding:0;
      border-radius:18px;
      overflow:hidden;
      background:#fff;
      border:1px solid rgba(3,78,162,0.12);
      box-shadow:0 14px 42px rgba(3,78,162,0.10);
      transition:transform 160ms ease, box-shadow 160ms ease;
    }

    .place-tile:hover{
      transform:translateY(-2px);
      box-shadow:0 18px 55px rgba(3,78,162,0.14);
    }

    .place-img{
      width:100%;
      aspect-ratio:16/9;
      background:#eef2f7;
    }

    .place-img img{
      width:100%;
      height:100%;
      object-fit:cover;
    }

    .place-body{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      padding:14px 14px;
      background:linear-gradient(180deg, rgba(3,78,162,0.035), rgba(3,78,162,0.012));
    }

    .place-title{
      margin:0;
      font-weight:900;
      color:#0f2f62;
      letter-spacing:-0.01em;
      font-size:15px;
      line-height:1.2;
    }

    .place-meta{
      margin:6px 0 0;
      color:#1f2b3f;
      opacity:.9;
      line-height:1.5;
      font-size:13.6px;
      max-width:34ch;
    }

    .place-arrow{
      flex:0 0 auto;
      width:36px;
      height:36px;
      border-radius:999px;
      border:1px solid rgba(3,78,162,0.18);
      background:rgba(255,255,255,0.75);
      display:flex;
      align-items:center;
      justify-content:center;
      margin-top:2px;
    }

    .place-arrow span{
      display:block;
      width:10px;
      height:10px;
      border-right:2px solid #0f2f62;
      border-bottom:2px solid #0f2f62;
      transform:rotate(-45deg);
      opacity:.9;
    }

    /* ===== VIDEO EMBED (MATCH ANDES STYLE) ===== */
    .video-embed{
      margin-top:16px;
      border-radius:18px;
      overflow:hidden;
      border:1px solid rgba(0,0,0,0.06);
      box-shadow:0 18px 55px rgba(3,78,162,0.10);
      background:#000;
    }

    .video-embed iframe{
      width:100%;
      aspect-ratio:16/9;
      height:auto;
      display:block;
      border:0;
    }

    /* ===== CAROUSEL (GALLERY) ===== */
    .carousel{
      margin-top:18px;
      background:#fff;
      border-radius:22px;
      border:1px solid rgba(0,0,0,0.06);
      box-shadow:0 18px 55px rgba(3,78,162,0.10);
      overflow:hidden;
      position:relative;
      z-index:1;
    }

    .carousel-viewport{
      overflow:hidden;
      width:100%;
      touch-action:pan-y;
    }

    .carousel-track{
      display:flex;
      width:100%;
      transform:translateX(0);
      transition:transform 450ms ease;
      will-change:transform;
    }

    .carousel-slide{
      min-width:100%;
      position:relative;
      aspect-ratio:16/9;
      background:#eef2f7;
    }

    .carousel-slide img{
      width:100%;
      height:100%;
      object-fit:cover;
    }

    .carousel-btn{
      position:absolute;
      top:50%;
      transform:translateY(-50%);
      width:44px;
      height:44px;
      border-radius:999px;
      border:1px solid rgba(255,255,255,0.35);
      background:rgba(15,47,98,0.55);
      backdrop-filter:blur(10px);
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:5;
    }

    .carousel-btn:hover{ background:rgba(15,47,98,0.70); }

    .carousel-btn.prev{ left:12px; }
    .carousel-btn.next{ right:12px; }

    .carousel-btn span{
      display:block;
      width:10px;
      height:10px;
      border-right:2px solid #fff;
      border-bottom:2px solid #fff;
      opacity:.95;
    }

    .carousel-btn.prev span{ transform:rotate(135deg); }
    .carousel-btn.next span{ transform:rotate(-45deg); }

    .carousel-ui{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 14px;
      border-top:1px solid rgba(0,0,0,0.06);
      background:linear-gradient(180deg, rgba(3,78,162,0.03), rgba(3,78,162,0.01));
    }

    .carousel-dots{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
    }

    .dot{
      width:10px;
      height:10px;
      border-radius:999px;
      border:1px solid rgba(3,78,162,0.25);
      background:rgba(3,78,162,0.12);
      cursor:pointer;
      padding:0;
    }

    .dot.active{
      background:rgba(3,78,162,0.85);
      border-color:rgba(3,78,162,0.85);
    }

    .carousel-counter{
      font-weight:700;
      font-size:13px;
      color:#0f2f62;
      opacity:.9;
      white-space:nowrap;
    }

    /* ===== CTA ===== */
    .cta{
      margin:28px 0 56px;
      background:var(--brand-blue);
      color:#fff;
      border-radius:24px;
      padding:22px;
      box-shadow:0 22px 60px rgba(3,78,162,0.22);
    }

    .cta h3{
      margin:0 0 8px;
      font-family:Montserrat,Inter,sans-serif;
      font-weight:800;
      letter-spacing:-0.02em;
      font-size:20px;
    }

    .cta p{
      margin:0;
      color:rgba(255,255,255,0.92);
      line-height:1.7;
      font-size:15.5px;
      max-width:85ch;
    }

    /* ===== MOBILE ===== */
    @media(max-width:900px){
      .grid{ grid-template-columns:1fr; }
      .places-grid{ grid-template-columns:1fr; }
      .hero-inner{ text-align:center; }
      .hero p{ margin:0 auto; }
    }

    @media(max-width:480px){
      .hero{ min-height:60vh; }
      .cta{ border-radius:20px; }
      .carousel-btn{ width:40px; height:40px; }
    }
  </style>
</head>

<body>
  <div id="siteHeader"></div>

  <main>
    <!-- HERO -->
    <section class="hero" aria-label="Amazon hero image">
      <div class="hero-inner">
        <div class="kicker">Region Guide • Live</div>
        <h1>Amazon (Oriente)</h1>
        <p>
          Ecuador’s rainforest region is about gateways and lodge-based experiences, not big cities.
          This hub will help you choose the right entry point, reserve, and trip style for your time and comfort level.
        </p>
      </div>
    </section>

    <!-- CONTENT -->
    <div class="wrap">

      <section class="section">
        <h2>What Makes The Amazon Special</h2>
        <p>
          The Amazon is immersive. Days revolve around rivers, trails, canoe trips, wildlife, and guided experiences.
          The key decision is not “which town,” but “how deep do you want to go” and “how many days do you have.”
        </p>

        <div class="grid center-stack">
          <div class="card">
            <h3>Signature Highlights</h3>
            <ul>
              <li>Guided jungle walks, canoe rides, and night wildlife excursions</li>
              <li>River towns as gateways to rainforest lodges and reserves</li>
              <li>Wildlife sightings: monkeys, caimans, birds, frogs, and more</li>
              <li>Deep biodiversity in protected areas and indigenous territories</li>
            </ul>

            <div class="pill-row" aria-label="Amazon experience tags">
              <span class="tag">Rainforest</span>
              <span class="tag">Wildlife</span>
              <span class="tag">Lodges</span>
              <span class="tag">Guided</span>
            </div>
          </div>

          <div class="stack-right">
            <div class="mini">
              <h3>Best For</h3>
              <ul>
                <li>First-time Amazon travelers (short gateway stays)</li>
                <li>Nature lovers and wildlife-focused trips</li>
                <li>Adventure: rafting, river days, jungle hikes</li>
                <li>Longer immersive lodge-based journeys</li>
              </ul>
            </div>

            <div class="mini">
              <h3>Trip Styles We Will Cover</h3>
              <ul>
                <li>2–4 day Amazon intro trips</li>
                <li>Multi-day lodge-based adventures</li>
                <li>Family-friendly experiences and easy logistics</li>
                <li>Photography and wildlife-heavy itineraries</li>
              </ul>
            </div>
          </div>
        </div>
      </section>

      <!-- AMAZON DESTINATIONS (TILES) -->
      <section class="section">
        <h2>Amazon Gateways and Reserves</h2>
        <p>
          These four locations give you a strong foundation: two easy gateways from Quito, plus two iconic protected areas.
          Each destination page will include planning notes, a gallery carousel, and the same unified weather card used across location pages.
        </p>

        <div class="grid">
          <div class="card">
            <h3>Featured Locations</h3>

            <div class="places-grid" aria-label="Amazon destination tiles">
              <a class="place-tile" href="/regions/amazon/tena/" aria-label="Open Tena page">
                <div class="place-img">
                  <img src="/assets/images/EE-Assets-46-Tena.jpg" alt="Tena">
                </div>
                <div class="place-body">
                  <div>
                    <div class="place-title">Tena</div>
                    <div class="place-meta">Main gateway from Quito. Rafting capital and easy jungle access.</div>
                  </div>
                  <div class="place-arrow" aria-hidden="true"><span></span></div>
                </div>
              </a>

              <a class="place-tile" href="/regions/amazon/misahualli/" aria-label="Open Misahuallí page">
                <div class="place-img">
                  <img src="/assets/images/EE-Assets-47-Misahualli.jpg" alt="Misahuallí">
                </div>
                <div class="place-body">
                  <div>
                    <div class="place-title">Misahuallí</div>
                    <div class="place-meta">Small river town vibe, wildlife centers, relaxed Amazon intro.</div>
                  </div>
                  <div class="place-arrow" aria-hidden="true"><span></span></div>
                </div>
              </a>

              <a class="place-tile" href="/regions/amazon/yasuni-national-park/" aria-label="Open Yasuní National Park page">
                <div class="place-img">
                  <img src="/assets/images/EE-Assets-48-YasuniNationalPark.jpg" alt="Yasuní National Park">
                </div>
                <div class="place-body">
                  <div>
                    <div class="place-title">Yasuní National Park</div>
                    <div class="place-meta">Deep Amazon, extreme biodiversity, experience-led lodge trips.</div>
                  </div>
                  <div class="place-arrow" aria-hidden="true"><span></span></div>
                </div>
              </a>

              <a class="place-tile" href="/regions/amazon/cuyabeno-wildlife-reserve/" aria-label="Open Cuyabeno Wildlife Reserve page">
                <div class="place-img">
                  <img src="/assets/images/EE-Assets-49-Cuyabeno.jpg" alt="Cuyabeno Wildlife Reserve">
                </div>
                <div class="place-body">
                  <div>
                    <div class="place-title">Cuyabeno Wildlife Reserve</div>
                    <div class="place-meta">Lagoon system, canoe exploration, excellent wildlife sightings.</div>
                  </div>
                  <div class="place-arrow" aria-hidden="true"><span></span></div>
                </div>
              </a>
            </div>

            <div class="pill-row" aria-label="Amazon destination tags">
              <span class="tag">Gateway Towns</span>
              <span class="tag">Protected Areas</span>
              <span class="tag">Guided Lodges</span>
              <span class="tag">Wildlife</span>
            </div>
          </div>

          <div class="card">
            <h3>How To Use This Hub</h3>
            <ul>
              <li>If you have 2–4 days: start with Tena or Misahuallí for easy access</li>
              <li>If you want deep immersion: choose Yasuní or Cuyabeno as your anchor</li>
              <li>Expect guided schedules, early mornings, and nature-led pacing</li>
              <li>Pack for humidity, rain, and muddy trails</li>
            </ul>

            <div class="video-embed" aria-label="Amazon video">
              <iframe
                src="https://www.youtube.com/embed/ATSm3IdETuc"
                title="Cuyabeno Wildlife Reserve"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                referrerpolicy="strict-origin-when-cross-origin"
                allowfullscreen>
              </iframe>
            </div>
          </div>
        </div>
      </section>

      <section class="section">
        <h2>What To Expect On This Page Next</h2>
        <p>
          We are building this region hub into a complete guide with lodge planning, trip length templates,
          and clear decision-making for first-time vs deep Amazon travel.
        </p>

        <div class="grid">
          <div class="card">
            <h3>Planned Sections</h3>
            <ul>
              <li>How to choose: gateway stay vs lodge-based trip</li>
              <li>Top experiences: canoeing, night walks, wildlife, culture</li>
              <li>Suggested trip lengths (2–4 days vs 5–8 days)</li>
              <li>Seasonality, costs, and packing checklist</li>
              <li>Trusted partners and curated lodge recommendations</li>
            </ul>
          </div>

          <div class="card">
            <h3>Quick Planning Mindset</h3>
            <ul>
              <li>Choose depth first, then choose your entry point</li>
              <li>Longer stays improve wildlife and immersion</li>
              <li>Guided trips are the best way to experience the jungle safely</li>
              <li>Keep expectations realistic, nature is unpredictable and that is the point</li>
            </ul>
          </div>
        </div>
      </section>

      <section class="section">
        <h2>Gallery and Highlights</h2>

        <div id="amazonCarousel" class="carousel" aria-label="Amazon image gallery">
          <button class="carousel-btn prev" type="button" aria-label="Previous image">
            <span aria-hidden="true"></span>
          </button>

          <div class="carousel-viewport">
            <div class="carousel-track">
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-1.jpg" alt="Amazon highlight 1"></div>
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-2.jpg" alt="Amazon highlight 2"></div>
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-3.jpg" alt="Amazon highlight 3"></div>
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-4.jpg" alt="Amazon highlight 4"></div>
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-5.jpg" alt="Amazon highlight 5"></div>
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-6.jpg" alt="Amazon highlight 6"></div>
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-7.jpg" alt="Amazon highlight 7"></div>
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-8.jpg" alt="Amazon highlight 8"></div>
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-9.jpg" alt="Amazon highlight 9"></div>
              <div class="carousel-slide"><img src="/assets/images/EE-Carousel-Amazon-10.jpg" alt="Amazon highlight 10"></div>
            </div>
          </div>

          <button class="carousel-btn next" type="button" aria-label="Next image">
            <span aria-hidden="true"></span>
          </button>

          <div class="carousel-ui">
            <div class="carousel-dots" aria-label="Carousel pagination"></div>
            <div class="carousel-counter" id="amazonCarouselCounter">1 / 10</div>
          </div>
        </div>
      </section>

      <section class="cta" aria-label="Newsletter future CTA">
        <h3>Coming Soon: Curated Amazon Updates</h3>
        <p>
          This region hub will evolve into curated guides and a newsletter format where travelers discover experiences and trusted partners.
          Next step: lodge decision guides, sample itineraries, and a reusable gallery carousel for each location page.
        </p>
      </section>

    </div>
  </main>

  <div id="siteFooter"></div>

  <script src="/assets/js/site.js"></script>

  <script>
    (function(){
      async function inject(id, url){
        const el = document.getElementById(id);
        if(!el) return;
        const res = await fetch(url, { cache: "no-store" });
        el.innerHTML = await res.text();
      }
      inject("siteHeader", "/assets/includes/header.html");
      inject("siteFooter", "/assets/includes/footer.html");
    })();
  </script>

  <script>
    /* Amazon carousel */
    (function(){
      const root = document.getElementById("amazonCarousel");
      if(!root) return;

      const track = root.querySelector(".carousel-track");
      const slides = Array.from(root.querySelectorAll(".carousel-slide"));
      const prevBtn = root.querySelector(".carousel-btn.prev");
      const nextBtn = root.querySelector(".carousel-btn.next");
      const dotsWrap = root.querySelector(".carousel-dots");
      const counter = root.querySelector("#amazonCarouselCounter");

      let index = 0;

      const AUTOPLAY_MS = 5000;
      const prefersReducedMotion = window.matchMedia && window.matchMedia("(prefers-reduced-motion: reduce)").matches;

      let autoplayTimer = null;
      let autoplayEnabled = !prefersReducedMotion;

      function setIndex(next){
        index = (next + slides.length) % slides.length;
        track.style.transform = `translateX(-${index * 100}%)`;
        updateDots();
        updateCounter();
      }

      function updateCounter(){
        if(counter) counter.textContent = `${index + 1} / ${slides.length}`;
      }

      function updateDots(){
        const dots = Array.from(dotsWrap.querySelectorAll(".dot"));
        dots.forEach((d,i) => d.classList.toggle("active", i === index));
      }

      function buildDots(){
        dotsWrap.innerHTML = "";
        slides.forEach((_, i) => {
          const b = document.createElement("button");
          b.type = "button";
          b.className = "dot" + (i === 0 ? " active" : "");
          b.setAttribute("aria-label", `Go to image ${i + 1}`);
          b.addEventListener("click", () => {
            setIndex(i);
          });
          dotsWrap.appendChild(b);
        });
      }

      function next(){ setIndex(index + 1); }
      function prev(){ setIndex(index - 1); }

      function startAutoplay(){
        if(!autoplayEnabled) return;
        stopAutoplay();
        autoplayTimer = setInterval(next, AUTOPLAY_MS);
      }

      function stopAutoplay(){
        if(autoplayTimer){
          clearInterval(autoplayTimer);
          autoplayTimer = null;
        }
      }

      if(prevBtn) prevBtn.addEventListener("click", () => { prev(); stopAutoplay(); });
      if(nextBtn) nextBtn.addEventListener("click", () => { next(); stopAutoplay(); });

      root.addEventListener("keydown", (e) => {
        if(e.key === "ArrowLeft"){ prev(); stopAutoplay(); }
        if(e.key === "ArrowRight"){ next(); stopAutoplay(); }
      });

      let startX = 0;
      let isDown = false;

      const viewport = root.querySelector(".carousel-viewport");
      viewport.addEventListener("pointerdown", (e) => {
        isDown = true;
        startX = e.clientX;
        viewport.setPointerCapture(e.pointerId);
      });

      viewport.addEventListener("pointerup", (e) => {
        if(!isDown) return;
        isDown = false;
        const dx = e.clientX - startX;
        const threshold = 40;
        if(dx > threshold){ prev(); stopAutoplay(); }
        if(dx < -threshold){ next(); stopAutoplay(); }
      });

      viewport.addEventListener("pointercancel", () => { isDown = false; });

      root.addEventListener("mouseenter", stopAutoplay);
      root.addEventListener("mouseleave", startAutoplay);
      root.addEventListener("focusin", stopAutoplay);
      root.addEventListener("focusout", startAutoplay);

      root.tabIndex = 0;
      buildDots();
      updateCounter();
      setIndex(0);
      startAutoplay();
    })();
  </script>

</body>
</html>
